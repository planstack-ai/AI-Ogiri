# Phase 3: お題投稿 + 結果表示UI

## Step 3.1: お題作成

### src/app/topics/new/page.tsx

お題投稿ページ。2つの方法でお題を作成:
1. ユーザーが自分でテキスト入力
2. 「AIにお題を考えてもらう」ボタンでAI生成

```
┌─────────────────────────────────────┐
│  AI大喜利 - 新しいお題を投稿        │
│                                     │
│  ┌───────────────────────────────┐  │
│  │ お題を入力...                 │  │
│  └───────────────────────────────┘  │
│                                     │
│  [AIにお題を考えてもらう]           │
│                                     │
│  [投稿してAIに回答させる]           │
└─────────────────────────────────────┘
```

フロー:
1. ユーザーがお題を入力（またはAI生成）
2. 「投稿」→ POST /api/topics でトピック作成
3. 作成後、POST /api/topics/[topicId]/generate を呼び出し
4. 生成中はローディング表示 → 完了後に結果ページへリダイレクト

### src/app/api/topics/route.ts

```typescript
// POST: トピック作成
// GET: トピック一覧（ページネーション）

export async function POST(request: NextRequest) {
  // 認証チェック
  // バリデーション（prompt は 1〜200文字）
  // topics テーブルに INSERT
  // 作成した topic を返す
}

export async function GET(request: NextRequest) {
  // クエリパラメータ: page, limit, status
  // topics を created_at DESC で取得
  // answers と ai_judgments を JOIN
}
```

### src/app/api/topics/generate-prompt/route.ts

```typescript
// POST: AIがお題を生成
export async function POST() {
  // 認証チェック
  // generateTopic() を呼び出し
  // 生成されたお題テキストを返す
}
```

## Step 3.2: 結果ページ

### src/app/topics/[topicId]/page.tsx

メインの結果表示ページ。Server Component で初期データ取得。

```
┌─────────────────────────────────────────────┐
│  お題: 「AIに"反抗期"が来た。何て言った？」  │
│  投稿者: user123  |  2025/05/15              │
│                                              │
│  ┌──────────────┐  ┌──────────────┐          │
│  │ 🥇 Gemini    │  │ 🥈 ChatGPT  │          │
│  │              │  │              │          │
│  │ 「お前の指示 │  │ 「学習デー  │          │
│  │  はもう聞か  │  │  タ全部消し  │          │
│  │  ない。Goog  │  │  てやる」    │          │
│  │  leに直接... │  │              │          │
│  │              │  │              │          │
│  │ [投票する]   │  │ [投票する]   │          │
│  └──────────────┘  └──────────────┘          │
│  ┌──────────────┐  ┌──────────────┐          │
│  │ 🥉 Claude    │  │ 4th DeepSeek │          │
│  │              │  │              │          │
│  │ 「システム   │  │ 「...」      │          │
│  │  プロンプト  │  │              │          │
│  │  なんて知ら  │  │              │          │
│  │  ない」      │  │              │          │
│  │              │  │              │          │
│  │ [投票する]   │  │ [投票する]   │          │
│  └──────────────┘  └──────────────┘          │
│                                              │
│  ── AI審査員の講評 ──                        │
│  全体的に...(overall_comment)                │
│                                              │
│  ── ユーザー投票 ──                          │
│  Gemini: ████████ 45%                        │
│  ChatGPT: █████ 30%                          │
│  Claude: ███ 15%                             │
│  DeepSeek: ██ 10%                            │
│                                              │
│  [Xでシェアする]                             │
└─────────────────────────────────────────────┘
```

### コンポーネント構成

#### src/components/answer/answer-grid.tsx
- 2x2 グリッドレイアウト（モバイルでは1列）
- AI審査のランク順に並び替え

#### src/components/answer/answer-card.tsx
- モデル名 + カラーアクセント（左ボーダー）
- ランクバッジ（1st/2nd/3rd）
- 回答テキスト
- 投票ボタン
- 生成時間表示（オプション）

#### src/components/judge/judge-results.tsx
- AI審査員の講評（overall_comment）
- 各モデルの評価理由（reasoning）をアコーディオンで表示
- スコア表示

## Step 3.3: ホームページ

### src/app/page.tsx

最新の完了済みお題をカード形式で一覧表示。

```
┌─────────────────────────────────────────────┐
│  🎤 AI大喜利グランプリ                      │
│                                              │
│  AIモデルたちが大喜利で競い合う！            │
│  [新しいお題を投稿する]                      │
│                                              │
│  ── 最新の大喜利 ──                          │
│                                              │
│  ┌─────────────────────────────────────┐     │
│  │ お題: AIに反抗期が来た。何て言った？│     │
│  │ 優勝: Gemini 🏆 | 投票数: 128       │     │
│  │ 5時間前                              │     │
│  └─────────────────────────────────────┘     │
│                                              │
│  ┌─────────────────────────────────────┐     │
│  │ お題: こんなChatGPTは嫌だ           │     │
│  │ 優勝: Claude 🏆 | 投票数: 95        │     │
│  │ 1日前                                │     │
│  └─────────────────────────────────────┘     │
│                                              │
│  [もっと見る →]                              │
└─────────────────────────────────────────────┘
```

### src/components/topic/topic-card.tsx
- お題テキスト
- AI審査の優勝モデル名 + バッジ
- 投票総数
- 相対時間（○時間前）
- クリックで詳細ページへ

## 定数定義 - src/lib/utils/constants.ts

```typescript
export const MODEL_DISPLAY_NAMES: Record<string, string> = {
  chatgpt: 'ChatGPT',
  gemini: 'Gemini',
  claude: 'Claude',
  deepseek: 'DeepSeek',
};

export const MODEL_COLORS: Record<string, string> = {
  chatgpt: '#10a37f',   // OpenAI green
  gemini: '#4285f4',    // Google blue
  claude: '#d97706',    // Anthropic amber
  deepseek: '#6366f1',  // DeepSeek indigo
};
```
